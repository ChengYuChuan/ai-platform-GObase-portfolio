# Default values for ai-platform
# This is a YAML-formatted file.

# Global settings
global:
  imageRegistry: ""
  imagePullSecrets: []
  storageClass: ""

# Common labels
commonLabels: {}

# Namespace
namespace: ai-platform

# =============================================================================
# Gateway Service (Go)
# =============================================================================
gateway:
  enabled: true
  replicaCount: 2

  image:
    repository: ai-platform/gateway
    tag: "latest"
    pullPolicy: IfNotPresent

  service:
    type: ClusterIP
    port: 8080

  resources:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"

  config:
    logLevel: "INFO"
    logFormat: "json"
    rateLimit:
      enabled: true
      requestsPerSecond: 100
      burst: 200
    cache:
      enabled: true
      ttlSeconds: 300

  autoscaling:
    enabled: false
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilization: 70
    targetMemoryUtilization: 80

  nodeSelector: {}
  tolerations: []
  affinity: {}

# =============================================================================
# RAG Service (Python)
# =============================================================================
ragService:
  enabled: true
  replicaCount: 1

  image:
    repository: ai-platform/rag-service
    tag: "latest"
    pullPolicy: IfNotPresent

  service:
    type: ClusterIP
    port: 8000

  resources:
    requests:
      memory: "512Mi"
      cpu: "250m"
    limits:
      memory: "2Gi"
      cpu: "1"

  config:
    chunkSize: 1000
    chunkOverlap: 200
    embeddingModel: "text-embedding-3-small"
    topK: 5

  persistence:
    enabled: true
    size: 10Gi
    storageClass: ""

  nodeSelector: {}
  tolerations: []
  affinity: {}

# =============================================================================
# Dashboard (TypeScript/Next.js)
# =============================================================================
dashboard:
  enabled: true
  replicaCount: 1

  image:
    repository: ai-platform/dashboard
    tag: "latest"
    pullPolicy: IfNotPresent

  service:
    type: ClusterIP
    port: 3000

  resources:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "256Mi"
      cpu: "250m"

  nodeSelector: {}
  tolerations: []
  affinity: {}

# =============================================================================
# Redis (Caching)
# =============================================================================
redis:
  enabled: true
  architecture: standalone
  auth:
    enabled: false
  master:
    persistence:
      enabled: true
      size: 1Gi

# =============================================================================
# PostgreSQL (Metadata Storage)
# =============================================================================
postgresql:
  enabled: true
  auth:
    username: postgres
    password: ""  # Set via secrets
    database: ragdb
  primary:
    persistence:
      enabled: true
      size: 10Gi

# =============================================================================
# Qdrant (Vector Database)
# =============================================================================
qdrant:
  enabled: true
  replicaCount: 1

  image:
    repository: qdrant/qdrant
    tag: "latest"
    pullPolicy: IfNotPresent

  service:
    type: ClusterIP
    httpPort: 6333
    grpcPort: 6334

  resources:
    requests:
      memory: "512Mi"
      cpu: "250m"
    limits:
      memory: "2Gi"
      cpu: "1"

  persistence:
    enabled: true
    size: 10Gi
    storageClass: ""

# =============================================================================
# Ingress
# =============================================================================
ingress:
  enabled: true
  className: nginx

  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-body-size: "50m"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "300"
    nginx.ingress.kubernetes.io/enable-cors: "true"
    nginx.ingress.kubernetes.io/limit-rps: "100"
    cert-manager.io/cluster-issuer: "letsencrypt-prod"

  hosts:
    api:
      host: api.ai-platform.example.com
      paths:
        - path: /
          pathType: Prefix
    dashboard:
      host: app.ai-platform.example.com
      paths:
        - path: /
          pathType: Prefix

  tls:
    enabled: true
    secretName: ai-platform-tls

# =============================================================================
# Secrets
# =============================================================================
secrets:
  # API Keys - should be provided via external secret management in production
  openaiApiKey: ""
  anthropicApiKey: ""

  # Database credentials
  postgresPassword: ""

# =============================================================================
# Service Account & RBAC
# =============================================================================
serviceAccount:
  create: true
  name: ai-platform
  annotations: {}

rbac:
  create: true

# =============================================================================
# Network Policies
# =============================================================================
networkPolicy:
  enabled: true

# =============================================================================
# Pod Security
# =============================================================================
podSecurityContext:
  runAsNonRoot: true
  fsGroup: 1000

securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 1000
  capabilities:
    drop:
      - ALL

# =============================================================================
# Monitoring
# =============================================================================
monitoring:
  enabled: true
  serviceMonitor:
    enabled: false
    interval: 30s
    scrapeTimeout: 10s
